title="Resident Comsumption for North Eastern",
header=F,
font.size = "tiny",
type = "text",
algin = T,
single = F,
column.sep.width = "1pt",
digits =2)
stargazer(model_Res4,model_Con4,
title="Resident Consumption for West",
header=F,
font.size = "tiny",
type = "text",
algin = T,
single = F,
column.sep.width = "1pt",
digits =2)
plot(model_Res1)
plot(model_Con1)
plot(model_Res2)
plot(model_Con2)
plot(model_Res3)
plot(model_Con3)
print("GAP")
plot(model_Res4)
plot(model_Con4)
half_step <- data.frame("Years" = c(2010:2024), "Y hat" = Predict(model_Res1), "Y hat2" = Predict(model_Res2), "Y hat3" = Predict(model_Res3), "Y hat4" = Predict(model_Res4))
other_half <- data.frame("Years" = c(2010:2024), "Y hat" = Predict(model_Con1), "Y hat2" = Predict(model_Con2), "Y hat3" = Predict(model_Con3), "Y hat4" = Predict(model_Con4))
hat_res1 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat`, group = "red"))
hat_res1 <- hat_res1 + geom_line(col = "red")
hat_res2 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat2`, group = "blue"))
hat_res2 <- hat_res2 + geom_line(col = "blue")
hat_res3 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat3`, group = "purple"))
hat_res3 <- hat_res3 + geom_line(col = "purple")
hat_res4 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat4`, group = "black"))
hat_res4 <- hat_res4 + geom_line(col = "black")
RES <- ggplot(data = NG, aes(x = Years, y = `Res consumption`, group = "forestgreen"))
RES <- RES + geom_line(col = "forestgreen")
hat_res1
hat_res2
hat_res3
hat_res4
RES
hat_con1 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat`, group = "red"))
hat_con1 <- hat_con1 + geom_line(col = "red")
hat_con2 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat2`, group = "blue"))
hat_con2 <- hat_con2 + geom_line(col = "blue")
hat_con3 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat3`, group = "purple"))
hat_con3 <- hat_con3 + geom_line(col = "purple")
hat_con4 <- ggplot(data = half_step, aes(x = Years, y = `Y.hat4`, group = "black"))
hat_con4 <- hat_con4 + geom_line(col = "black")
CON <- ggplot(data = NG, aes(x = Years, y = `Res consumption`, group = "forestgreen"))
CON <- CON + geom_line(col = "forestgreen")
hat_con1
hat_con2
hat_con3
hat_con4
CON
knitr::opts_chunk$set(echo = TRUE)
source("05_percent_map.R")
source("04_percentage_changes.R")
source("02_funct_Plots.R")
# Load cleaned data
fixed_data <- readRDS("cleaned_data.RDS")
# Separate Years_From_To into Start and End
fixed_data <- fixed_data %>%
separate(Years_From_To, into = c("Start", "End"), sep = "-", convert = TRUE, fill = "right") %>%
mutate(
Start = as.integer(Start),
End = if_else(is.na(End), Start, as.integer(End))
)
# Count players per school PER YEAR
yearly_summary <- fixed_data %>%
group_by(School, Start) %>%
summarise(Players = n(), .groups = "drop")
# Get unique schools and global y-axis limit
teams <- unique(yearly_summary$School)
y_max <- max(yearly_summary$Players, na.rm = TRUE)
# Generate plots for each school (YEARLY)
plots <- list()
for (team in teams) {
school_data <- yearly_summary %>% filter(School == team)
p <- ggplot(school_data, aes(x = factor(Start), y = Players, fill = factor(Start))) +
geom_bar(stat = "identity", width = 0.5) +
scale_y_continuous(limits = c(0, y_max)) +
labs(title = team, x = "Year", y = "Number of Players") +
theme_minimal(base_size = 10) +
theme(
legend.position = "none",
plot.title = element_text(hjust = 0.5, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
plots[[team]] <- p
}
# Display plots (4 per page)
for (i in seq(1, length(plots), by = 4)) {
grid.arrange(
grobs = plots[i:min(i + 3, length(plots))],
ncol = 2, nrow = 2
)
}
packages <- c(
"tidyverse",   # data wrangling, plotting
"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom"
)
source("02_funct_Plots.R")
packages <- c(
"tidyverse",   # data wrangling, plotting
"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom"
)
# Install any missing packages automatically
installed <- rownames(installed.packages())
for (p in packages) {
if (!(p %in% installed)) {
install.packages(p)
}
library(p, character.only = TRUE)
}
source("02_funct_Plots.R")
# This chunk sources the table script to summarize data numerically.
# It creates a tibble table with player counts by school and year
# Outcome: A table is generated and printed, providing exact counts for comparison.
source("03_numeric_Table.R")
counts_by_school <- data %>%
group_by(School, start_year) %>%
summarise(count = n(), .groups = "drop")
models_by_school <- counts_by_school %>%
group_by(School) %>%
nest() %>%
mutate(
model = map(data, ~ glm(count ~ start_year,
family = "poisson",
data = .x)),
results = map(model, tidy)   # model coefficients
)
walk2(
models_by_school$School,
models_by_school$model,
~ {
cat("\n=====================================\n")
cat("Poisson Model for School:", .x, "\n")
cat("=====================================\n")
print(summary(.y))
}
)
source("06_poisson_model.R")
packages <- c(
"tidyverse",   # data wrangling, plotting
"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom",
"purrr"
)
# Install any missing packages automatically
installed <- rownames(installed.packages())
for (p in packages) {
if (!(p %in% installed)) {
install.packages(p)
}
library(p, character.only = TRUE)
}
source("06_poisson_model.R")
# This chunk loads the script to attach necessary packages like tidyverse and gridExtra.
# It sets up the environment for data manipulation and visualization.
# Outcome: Packages are installed and enabled
source("00_requirements.R")
source("06_poisson_model.R")
warnings()
source("06_poisson_model.R")
start <- fixed_data$start_year
counts_by_school <- fixed_data %>%
group_by(School, Start) %>%
summarise(count = n(), .groups = "drop")
models_by_school <- counts_by_school %>%
group_by(School) %>%
nest() %>%
mutate(
model = map(data, ~ glm(count ~ Start,
family = "poisson",
data = .x)),
results = map(model, tidy)   # model coefficients
)
walk2(
models_by_school$School,
models_by_school$model,
~ {
cat("\n=====================================\n")
cat("Poisson Model for School:", .x, "\n")
cat("=====================================\n")
print(summary(.y))
}
)
source("06_poisson_model.R")
heatmap <- ggplot(heatmap_data, aes(x = Label, y = School, fill = pct_change)) +
geom_tile(color = "white") +
scale_fill_gradient2(
low = "red",
mid = "orange",
high = "yellow",
midpoint = 0,
name = "% Change"
) +
theme_minimal(base_size = 12) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5, face = "bold")
) +
labs(
title = "Year-to-Year Percent Change in Player Draft Counts (2011–2025)",
x = "Year Transition",
y = "School"
)
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
ggplot(data_set_summary, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", size = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(cleaned_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", size = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(cleaned_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(cleaned_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(cleaned_data, aes(x = start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(fixed_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(fixed_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(fixed_data, aes(x = Start, y = Player)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(data_set_summary, aes(Start, Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(fixed_data, aes(Start, Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(fixed_data, aes(Start, Player, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
start <- fixed_data$start_year
counts_by_school <- fixed_data %>%
group_by(School, Start) %>%
summarise(count = n(), .groups = "drop")
ggplot(fixed_data, aes(Start, counts_by_school, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(data_set_summary, aes(x = Start, y = Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
data_set <- readRDS("cleaned_data.RDS")
ggplot(data_set, aes(x = Start, y = Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
data_set <- readRDS("cleaned_data.RDS")
ggplot(data_set, aes(x = start_year, y = Player, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
data_set <- readRDS("cleaned_data.RDS")
data_set_summary <- data_set %>%
group_by(School, Start) %>%
summarise(Players = n(), .groups = "drop") %>%
arrange(School, Start)
data_set <- readRDS("cleaned_data.RDS")
data_set_summary <- data_set %>%
group_by(School, start_year) %>%
summarise(Players = n(), .groups = "drop") %>%
arrange(School, start_year)
ggplot(data_set, aes(x = start_year, y = Player, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(data_set, aes(x = Start, y = Players, color = School)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 13) +
theme(
legend.position = "bottom",
panel.grid.minor = element_blank()
)
ggplot(data_set, aes(x = start_year, y = Players, color = School)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 13) +
theme(
legend.position = "bottom",
panel.grid.minor = element_blank()
)
yearly_summary_wide <- readRDS("~/Downloads/Stat107Project-The3rdTry/yearly_summary_wide.RDS")
ggplot(yearly, aes(x = Start, y = Players, color = School)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 13) +
theme(legend.position = "bottom")
ggplot(yearly, aes(x = Start, y = Players)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Regression Trends in NFL Player Counts (2011–2025)",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 12)
sec_total <- yearly %>%
group_by(Start) %>%
summarise(TotalPlayers = sum(Players))
ggplot(sec_total, aes(Start, TotalPlayers)) +
geom_line(size = 1.3) +
geom_point(size = 3) +
labs(
title = "Total NFL Player Output from SEC (2011–2025)",
x = "Year",
y = "Total Players"
) +
theme_minimal(base_size = 13)
change_table <- yearly %>%
group_by(School) %>%
summarise(
FirstYear = first(Start),
LastYear = last(Start),
Players_2011 = Players[Start == 2011],
Players_2025 = Players[Start == 2025],
Change = Players_2025 - Players_2011
)
ggplot(change_table, aes(x = School, y = Change, fill = Change)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(low = "red", high = "darkgreen") +
labs(
title = "Overall Change in NFL Player Counts (2011–2025)",
x = "School",
y = "Change in Player Counts"
) +
theme_minimal()
slopes <- yearly %>%
group_by(School) %>%
do(tidy(lm(Players ~ Start, data = .))) %>%
filter(term == "Start") %>%
rename(Slope = estimate)
ggplot(slopes, aes(x = reorder(School, Slope), y = Slope)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(
title = "Slope of Regression Lines (Players per Year)",
x = "School",
y = "Slope"
) +
theme_minimal()
