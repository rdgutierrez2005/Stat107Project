"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom"
)
source("02_funct_Plots.R")
packages <- c(
"tidyverse",   # data wrangling, plotting
"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom"
)
# Install any missing packages automatically
installed <- rownames(installed.packages())
for (p in packages) {
if (!(p %in% installed)) {
install.packages(p)
}
library(p, character.only = TRUE)
}
source("02_funct_Plots.R")
# This chunk sources the table script to summarize data numerically.
# It creates a tibble table with player counts by school and year
# Outcome: A table is generated and printed, providing exact counts for comparison.
source("03_numeric_Table.R")
counts_by_school <- data %>%
group_by(School, start_year) %>%
summarise(count = n(), .groups = "drop")
models_by_school <- counts_by_school %>%
group_by(School) %>%
nest() %>%
mutate(
model = map(data, ~ glm(count ~ start_year,
family = "poisson",
data = .x)),
results = map(model, tidy)   # model coefficients
)
walk2(
models_by_school$School,
models_by_school$model,
~ {
cat("\n=====================================\n")
cat("Poisson Model for School:", .x, "\n")
cat("=====================================\n")
print(summary(.y))
}
)
source("06_poisson_model.R")
packages <- c(
"tidyverse",   # data wrangling, plotting
"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom",
"purrr"
)
# Install any missing packages automatically
installed <- rownames(installed.packages())
for (p in packages) {
if (!(p %in% installed)) {
install.packages(p)
}
library(p, character.only = TRUE)
}
source("06_poisson_model.R")
# This chunk loads the script to attach necessary packages like tidyverse and gridExtra.
# It sets up the environment for data manipulation and visualization.
# Outcome: Packages are installed and enabled
source("00_requirements.R")
source("06_poisson_model.R")
warnings()
source("06_poisson_model.R")
start <- fixed_data$start_year
counts_by_school <- fixed_data %>%
group_by(School, Start) %>%
summarise(count = n(), .groups = "drop")
models_by_school <- counts_by_school %>%
group_by(School) %>%
nest() %>%
mutate(
model = map(data, ~ glm(count ~ Start,
family = "poisson",
data = .x)),
results = map(model, tidy)   # model coefficients
)
walk2(
models_by_school$School,
models_by_school$model,
~ {
cat("\n=====================================\n")
cat("Poisson Model for School:", .x, "\n")
cat("=====================================\n")
print(summary(.y))
}
)
source("06_poisson_model.R")
heatmap <- ggplot(heatmap_data, aes(x = Label, y = School, fill = pct_change)) +
geom_tile(color = "white") +
scale_fill_gradient2(
low = "red",
mid = "orange",
high = "yellow",
midpoint = 0,
name = "% Change"
) +
theme_minimal(base_size = 12) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5, face = "bold")
) +
labs(
title = "Year-to-Year Percent Change in Player Draft Counts (2011–2025)",
x = "Year Transition",
y = "School"
)
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
source("05_percent_map.R")
ggplot(data_set_summary, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", size = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(cleaned_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", size = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(cleaned_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(cleaned_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(cleaned_data, aes(x = start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(fixed_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
start <- fixed_data$start_year
ggplot(fixed_data, aes(x = Start, y = Players)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(fixed_data, aes(x = Start, y = Player)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 1) +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Linear Regression Trend for NFL Player Counts (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal(base_size = 12)
ggplot(data_set_summary, aes(Start, Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(fixed_data, aes(Start, Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(fixed_data, aes(Start, Player, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
start <- fixed_data$start_year
counts_by_school <- fixed_data %>%
group_by(School, Start) %>%
summarise(count = n(), .groups = "drop")
ggplot(fixed_data, aes(Start, counts_by_school, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines for All SEC Schools (2011–2025)",
x = "Year",
y = "Number of NFL Players"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(data_set_summary, aes(x = Start, y = Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
data_set <- readRDS("cleaned_data.RDS")
ggplot(data_set, aes(x = Start, y = Players, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
data_set <- readRDS("cleaned_data.RDS")
ggplot(data_set, aes(x = start_year, y = Player, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
data_set <- readRDS("cleaned_data.RDS")
data_set_summary <- data_set %>%
group_by(School, Start) %>%
summarise(Players = n(), .groups = "drop") %>%
arrange(School, Start)
data_set <- readRDS("cleaned_data.RDS")
data_set_summary <- data_set %>%
group_by(School, start_year) %>%
summarise(Players = n(), .groups = "drop") %>%
arrange(School, start_year)
ggplot(data_set, aes(x = start_year, y = Player, color = School)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(data_set, aes(x = Start, y = Players, color = School)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 13) +
theme(
legend.position = "bottom",
panel.grid.minor = element_blank()
)
ggplot(data_set, aes(x = start_year, y = Players, color = School)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 13) +
theme(
legend.position = "bottom",
panel.grid.minor = element_blank()
)
yearly_summary_wide <- readRDS("~/Downloads/Stat107Project-The3rdTry/yearly_summary_wide.RDS")
ggplot(yearly, aes(x = Start, y = Players, color = School)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
labs(
title = "Regression Lines of NFL Player Counts for All SEC Schools",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 13) +
theme(legend.position = "bottom")
ggplot(yearly, aes(x = Start, y = Players)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
facet_wrap(~ School, scales = "free_y", ncol = 4) +
labs(
title = "Regression Trends in NFL Player Counts (2011–2025)",
x = "Year",
y = "Player Counts"
) +
theme_minimal(base_size = 12)
sec_total <- yearly %>%
group_by(Start) %>%
summarise(TotalPlayers = sum(Players))
ggplot(sec_total, aes(Start, TotalPlayers)) +
geom_line(size = 1.3) +
geom_point(size = 3) +
labs(
title = "Total NFL Player Output from SEC (2011–2025)",
x = "Year",
y = "Total Players"
) +
theme_minimal(base_size = 13)
change_table <- yearly %>%
group_by(School) %>%
summarise(
FirstYear = first(Start),
LastYear = last(Start),
Players_2011 = Players[Start == 2011],
Players_2025 = Players[Start == 2025],
Change = Players_2025 - Players_2011
)
ggplot(change_table, aes(x = School, y = Change, fill = Change)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(low = "red", high = "darkgreen") +
labs(
title = "Overall Change in NFL Player Counts (2011–2025)",
x = "School",
y = "Change in Player Counts"
) +
theme_minimal()
slopes <- yearly %>%
group_by(School) %>%
do(tidy(lm(Players ~ Start, data = .))) %>%
filter(term == "Start") %>%
rename(Slope = estimate)
ggplot(slopes, aes(x = reorder(School, Slope), y = Slope)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(
title = "Slope of Regression Lines (Players per Year)",
x = "School",
y = "Slope"
) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
source("05_percent_map.R")
# This chunk loads the script to attach necessary packages like tidyverse and gridExtra.
# It sets up the environment for data manipulation and visualization.
# Outcome: Packages are installed and enabled
source("00_requirements.R")
slopes <- yearly %>%
group_by(School) %>%
do(tidy(lm(Players ~ Start, data = .))) %>%
filter(term == "Start") %>%
rename(Slope = estimate)
ggplot(slopes, aes(x = reorder(School, Slope), y = Slope)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(
title = "Slope of Regression Lines (Players per Year)",
x = "School",
y = "Slope"
) +
theme_minimal()
# This chunk loads the script to attach necessary packages like tidyverse and gridExtra.
# It sets up the environment for data manipulation and visualization.
# Outcome: Packages are installed and enabled
source("00_requirements.R")
source("05_percent_map.R")
source("06_poisson.R")
packages <- c(
"tidyverse",   # data wrangling, plotting
"readxl",      # read Excel files
"gridExtra",   # arrange multiple ggplots
"knitr",       # knitting tables
"dplyr",       # tidy data manipulation
"tidyr",       # data tidying
"tinytex",     # LaTeX distribution for rendering PDFs from RMarkdown
"ggplot2",      # grammar of graphics for creating plots
"broom",
"purrr"
)
# Install any missing packages automatically
installed <- rownames(installed.packages())
for (p in packages) {
if (!(p %in% installed)) {
install.packages(p)
}
library(p, character.only = TRUE)
}
source("06_poisson.R")
counts_by_school <- data_set %>%
group_by(School, start_year) %>%
summarise(count = n(), .groups = "drop")
models_by_school <- counts_by_school %>%
group_by(School) %>%
nest() %>%
mutate(
model = map(data, ~ glm(count ~ start_year,
family = "poisson",
data = .x)),
results = map(model, tidy)   # model coefficients
)
walk2(
models_by_school$School,
models_by_school$model,
~ {
cat("\n=====================================\n")
cat("Poisson Model for School:", .x, "\n")
cat("=====================================\n")
print(summary(.y))
}
)
knitr::opts_chunk$set(fig.height=4, fig.width=6, out.extra='trim=1cm')
knitr::opts_chunk$set
sec_total <- yearly %>%
group_by(Start) %>%
summarise(TotalPlayers = sum(Players))
ggplot(sec_total, aes(Start, TotalPlayers)) +
geom_line(size = 1.3) +
geom_point(size = 3) +
labs(
title = "Total NFL Player Output from SEC (2011–2025)",
x = "Year",
y = "Total Players"
) +
theme_minimal(base_size = 13)
sec_total <- yearly %>%
group_by(Start) %>%
summarise(TotalPlayers = sum(Players))
ggplot(sec_total, aes(Start, TotalPlayers)) +
geom_line(size = 1.3) +
geom_point(size = 3) +
labs(
title = "Total NFL Player Output from SEC (2011–2025)",
x = "Year",
y = "Total Players"
) +
theme_minimal(base_size = 13)
knitr::opts_chunk$set(
fig.width = 6,
fig.height = 4,
echo = FALSE,
message = FALSE,
warning = FALSE,
out.extra = 'trim=1cm'
)
